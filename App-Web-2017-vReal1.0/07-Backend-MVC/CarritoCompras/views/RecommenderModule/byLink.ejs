<!doctype html>
<html ng-app="appRecommender">
<head>
  <meta charset="UTF-8">
  <title>Recomendador</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular.min.js"> </script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"> </script>
</head>

<body ng-controller="Controller">

<div id="contenedor" class="row">
  <h1>Resultados de enlaces encontrados en relacion al recurso <a href="http://acm.rkbexplorer.com/id/100233">http://acm.rkbexplorer.com/id/100233</a><br></h1>
  <form action="/RecommenderModule/LinkPublication/createLinkToAPublication" method="post">
    <div class="container" style="background-color: black">
      <div class="row">
        <img class="img-cabecera"
             src="https://www.acm.org/binaries/content/gallery/acm/ctas/fca_logo.jpg/fca_logo.jpg/acm%3Adesktopcta"
             alt=""
             width="100%">
      </div>
      <br>
      <div class="row">
        <div class="col-md-5"></div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-success">Guardar Todo</button>
        </div>
        <div class="col-md-5"></div>
      </div>
      <br>
      <div class="row">
        <div class="col-md-4" ng-repeat="article in responseJson;">
          <div class="card">
            <img class="card-img-top"
                 src="http://blog.ciat.cgiar.org/wp-content/uploads/magazines.jpg"
                 alt="Card image cap"  height="150">
            <div class="fondo">

              <h3>Enlaces relacionados a la URI</h3>
              <div class="form-group row">
                <label class="col-2 col-form-label">Valor</label>
                <div class="col-10">
                  <input class="form-control" type="text"  value="{{article.links.value}}" id="links_Value" name="links_Value">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-2 col-form-label">tipo</label>
                <div class="col-10">
                  <input class="form-control" type="text"  value="{{article.links.type}}" id="link_Type" name="link_Type">
                </div>
              </div>
              <h3>Objetos relacionados a la URI</h3>
              <div class="form-group row">
                <label class="col-3 col-form-label">Propiedad</label>
                <div class="col-9">
                  <input class="form-control" type="text" value="{{article.o.value}}" id="o_Value" name="o_Value">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-2 col-form-label">Tipo</label>
                <div class="col-10">
                  <input class="form-control" type="text" value="{{article.o.type}}" id="o_Type" name="o_Type">
                </div>
              </div>
              <button type="submit" class="btn btn-success">Crear</button>

            </div>
            <br>
          </div><br>
        </div>
        <div class="col-md-4"></div>
        <div class="col-md-4"></div>
      </div>
      <br>
    </div>
  </form>
</div>


<!--<form action="/RecommenderModule/LinkPublication/createLinkToAPublication" method="post">-->


<!--<h2>Ejemplo Guardar uno por uno</h2>-->

<!--<div class="col-md-4">-->
<!--<div class="form-group row">-->
<!--<label class="col-2 col-form-label">Link Valor</label>-->
<!--<div class="col-10">-->
<!--<input class="form-control"   value="{{responseJson[2].links.value}}" type="text"  id="links_Value" name="links_Value">-->
<!--</div>-->
<!--</div>-->
<!--<div class="form-group row">-->
<!--<label class="col-2 col-form-label">Link tipo</label>-->
<!--<div class="col-10">-->
<!--<input class="form-control"  value="{{responseJson[2].links.type}} "type="text"  id="link_Type" name="link_Type">-->
<!--</div>-->
<!--</div>-->
<!--<div class="form-group row">-->
<!--<label class="col-2 col-form-label">Valor de Objeto</label>-->
<!--<div class="col-10">-->
<!--<input class="form-control" value="{{responseJson[2].o.value}}" type="text" id="o_Value" name="o_Value">-->
<!--</div>-->
<!--</div>-->
<!--<div class="form-group row">-->
<!--<label class="col-2 col-form-label">Tipo del objeto</label>-->
<!--<div class="col-10">-->
<!--<input class="form-control"  value="{{responseJson[2].o.type}}" type="text" id="o_Type" name="o_Type">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--<div class="col-md-4"></div>-->
<!--<div class="col-md-4"></div>-->

<!--<button type="submit" class="btn btn-success">Crear</button>-->

<!--</form>-->

<script>


  var app = angular.module("appRecommender",[]);
  app.controller("Controller",function ($scope,$http) {

    $scope.responseJson= [];


    let endPointAcm ="http://acm.rkbexplorer.com/sparql/";
    let queryParametersSparql = "?format=json&query=";
    let apiAcm = endPointAcm + queryParametersSparql  //api de ACM con sus parametros

    let id_Prefix = "PREFIX+id%3A%3Chttp%3A%2F%2Facm.rkbexplorer.com%2Fid%2F%3E%0D%0A";
    let rdf_Prefix = "PREFIX+rdf%3A%3Chttp%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%3E%0D%0A";
    let rdfs_Prefix = "PREFIX+rdfs%3A%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0D%0A";
    let akt_Prefix = "PREFIX+akt%3A%3Chttp%3A%2F%2Fwww.aktors.org%2Fontology%2Fportal%23%3E%0D%0A";
    let owl_Prefix = "PREFIX+owl%3A%3Chttp%3A%2F%2Fwww.w3.org%2F2002%2F07%2Fowl%23%3E%0D%0A";
    let akts_Prefix = "PREFIX+akts%3A%3Chttp%3A%2F%2Fwww.aktors.org%2Fontology%2Fsupport%23%3E%0D%0A";

    let prefix = id_Prefix+rdf_Prefix+rdfs_Prefix+akt_Prefix+owl_Prefix+akt_Prefix+akts_Prefix  //Prefijos Publicaciones ACM (Tomar en cuenta que akt_Prefix se repite para que funcione la consulta)

    let select = "SELECT+DISTINCT+%3Flinks+%3Fo%0D%0A";
    let where = "WHERE+%7B%3Chttp%3A%2F%2Facm.rkbexplorer.com%2Fid%2F100233%3E+%3Flinks+%3Fo%7D%0D%0A";
    let limit = "Limit+20";
    let querySparql = select+where+limit; //consulta Sparql

    let concatenation = apiAcm+prefix+querySparql;

    $http.get(concatenation)
      .success(function (data){
        console.log(data);
        $scope.responseJson = data.results.bindings;
        console.log("la url es:" + concatenation);
        console.log("numero de articulos:" + $scope.responseJson.length);

        for(let i = 0;i<$scope.responseJson.length;i ++){
          let linksValue = $scope.responseJson[i].links.value
          let linksType = $scope.responseJson[i].links.type
          let oValue = $scope.responseJson[i].o.value
          let oType = $scope.responseJson[i].o.type
          console.log(i+1+": valor de links es:"+ linksValue);
          console.log(i+1+": tipo de links es:"+ linksType);
          console.log(i+1+": valor de o es:"+ oValue);
          console.log(i+1+": tipo de o es:"+ oType);
        }
      })
      .error(function (err) {
      });


  });
</script>


<br><br>

</body>

</html>




